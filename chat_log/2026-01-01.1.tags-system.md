# 2026-01-01 Tags System for Observable Tracking

## Goal
Add a flexible tagging system to observable/operator records so UI can filter by tags (e.g., hide "internal" rxjs plumbing).

## Current State
- **Branch**: `feature/vite-instrumentation-v2`
- **All tests passing**: vitest (40) and browser (4)
- **Tags system implemented**: All entities can have `tags?: string[]`

## What's Working
- Vite plugin transforms rxjs source files at build time
- All rxjs operators/creation functions tagged with `["rxjs"]`
- Inner files (`innerFrom`, etc.) tagged with `["rxjs", "internal"]`
- Tags derived from filename: `operatorName.startsWith("inner")`

## Solution/Approach
- `tags?: string[]` added to base `Improved` type (all entities inherit)
- `_tagContext` module-level variable set by decorators
- `decorateCreate` and `decorateOperatorFun` accept `{ tags?: string[] }`
- Vite plugin passes appropriate tags based on file type

## Key Files Modified
- `src/tracking/v2/00.types.ts` - Added `tags?: string[]` to Improved base type
- `src/tracking/v2/01.patch-observable.ts` - `_tagContext` and decorator options
- `src/vite-plugin/v2.ts` - Tags derivation: `["rxjs"]` or `["rxjs", "internal"]`

## Key Insights
- Tags on base type = all entities (observable, operator_fun, subscription, etc.) can be tagged
- "rxjs" tag = from rxjs library (vs user code)
- "internal" tag = rxjs plumbing users don't directly call (inner*)
- UI can use `excludeTags: ["internal"]` to hide plumbing by default

## Tasks
- [ ] Implement UI tag filter (state with `excludeTags: string[]`)
- [ ] Add "Show internals" toggle to UI
- [ ] Consider if scan/reducer needs to read `getTagContext()` to store tags on records

## Open Questions
1. Should tags be stored on the observable record during scan? Currently decorator sets context but nothing reads it
2. Additional tag categories needed? (e.g., "deprecated", "custom")
